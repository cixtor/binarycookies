package binarycookies

import (
	"bytes"
	"testing"
)

func TestInvalidFile(t *testing.T) {
	data := []byte{
		0x54, 0x68, 0x65, 0x73, 0x65, 0x20, 0x61, 0x72,
		0x65, 0x20, 0x6e, 0x6f, 0x74, 0x20, 0x63, 0x6f,
		0x6f, 0x6b, 0x69, 0x65, 0x73, 0x2e, 0x0a,
	}

	r := bytes.NewReader(data)

	if _, err := New(r).Decode(); err == nil {
		t.Fatalf("invalid binary cookies file should return an error")
	}
}
